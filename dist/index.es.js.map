{"version":3,"file":"index.es.js","sources":["../src/firestore/useCollection.ts","../src/firestore/useDocument.ts","../src/firestore/useAddDocument.ts","../src/firestore/useSetDocument.ts","../src/firestore/useDeleteDocument.ts","../src/firestore/FirestoreDocument.tsx","../src/providers/FirebaseProvider.tsx","../src/providers/FirestoreProvider.tsx","../src/providers/FirebaseAuthProvider.tsx","../src/providers/FirebaseFunctionsProvider.tsx","../src/providers/FirebaseStorageProvider.tsx","../src/auth/useUser.ts","../src/auth/useSignOut.ts","../src/auth/SignOut.tsx","../src/auth/useSignUp.ts","../src/auth/useDeleteUser.ts","../src/auth/AuthorizationZone.tsx","../src/auth/useSignIn.ts","../src/auth/useSendEmailVerification.ts","../src/functions/useCallFunction.ts","../src/storage/useUploadFile.ts","../src/storage/useUploadFileResumable.ts","../src/storage/useDownloadLink.ts","../src/storage/StorageDownloadLink.tsx","../src/storage/useDownloadBlob.ts","../src/storage/useDownloadBytes.ts","../src/storage/useDeleteFile.ts","../src/storage/useFileMetadata.ts","../src/storage/StorageMetadata.tsx"],"sourcesContent":["// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FirebaseError } from \"firebase/app\";\nimport { Query, QuerySnapshot, getDocs, onSnapshot } from \"firebase/firestore\";\nimport { useEffect, useState } from \"react\";\n\ntype UseCollectionOptions = {\n  listen?: boolean;\n  listenToMetadataChanges?: boolean;\n};\n\ntype UseCollection = {\n  loading: boolean;\n  snapshot?: QuerySnapshot;\n  error?: FirebaseError;\n};\n\nexport const useCollection = (\n  query: Query,\n  { listen, listenToMetadataChanges }: UseCollectionOptions = {\n    listen: false,\n    listenToMetadataChanges: false,\n  },\n): UseCollection => {\n  const [loading, setLoading] = useState<boolean>(true);\n  const [snapshot, setSnapshot] = useState<QuerySnapshot | undefined>();\n  const [error, setError] = useState<FirebaseError | undefined>();\n\n  useEffect(() => {\n    setLoading(true);\n\n    if (listen) {\n      const unsub = onSnapshot(\n        query,\n        { includeMetadataChanges: listenToMetadataChanges },\n        (snap) => {\n          setSnapshot(snap);\n          setLoading(false);\n        },\n        (error) => setError(error),\n        () => setLoading(false),\n      );\n      return unsub;\n    } else {\n      getDocs(query)\n        .then((qSnapshot) => {\n          setSnapshot(qSnapshot);\n          setLoading(false);\n        })\n        .catch((e) => {\n          if (e instanceof FirebaseError) {\n            setError(e);\n            setLoading(false);\n          } else {\n            setLoading(false);\n            throw e;\n          }\n        })\n        .finally(() => setLoading(false));\n    }\n  }, [query, listen, listenToMetadataChanges]);\n\n  return { loading, snapshot, error };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FirebaseError } from \"firebase/app\";\nimport {\n  DocumentReference,\n  DocumentSnapshot,\n  getDoc,\n  onSnapshot,\n} from \"firebase/firestore\";\nimport { useEffect, useState } from \"react\";\n\ntype UseDocumentOptions = {\n  listen?: boolean;\n  listenToMetadataChanges?: boolean;\n};\n\ntype UseDocument = {\n  loading: boolean;\n  snapshot?: DocumentSnapshot;\n  error?: FirebaseError;\n};\n\nexport const useDocument = (\n  reference: DocumentReference,\n  { listen, listenToMetadataChanges }: UseDocumentOptions = {\n    listen: true,\n    listenToMetadataChanges: false,\n  },\n): UseDocument => {\n  const [loading, setLoading] = useState<boolean>(true);\n  const [snapshot, setSnapshot] = useState<DocumentSnapshot | undefined>();\n  const [error, setError] = useState<FirebaseError | undefined>();\n\n  useEffect(() => {\n    setLoading(true);\n    if (listen) {\n      const unsub = onSnapshot(\n        reference,\n        { includeMetadataChanges: listenToMetadataChanges },\n        (snap) => {\n          setSnapshot(snap);\n          setLoading(false);\n        },\n        (error) => setError(error),\n        () => setLoading(false),\n      );\n      return unsub;\n    } else {\n      getDoc(reference)\n        .then((snapshot) => {\n          setSnapshot(snapshot);\n          setLoading(false);\n        })\n        .catch((e) => {\n          if (e instanceof FirebaseError) {\n            setError(e);\n            setLoading(false);\n          } else {\n            setLoading(false);\n            throw e;\n          }\n        })\n        .finally(() => setLoading(false));\n    }\n  }, [reference, listen, listenToMetadataChanges]);\n\n  return { loading, snapshot, error };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FirebaseError } from \"firebase/app\";\nimport {\n  CollectionReference,\n  DocumentData,\n  DocumentReference,\n  addDoc,\n} from \"firebase/firestore\";\nimport { useState } from \"react\";\n\ntype UseAddDocumentState = \"ready\" | \"loading\" | \"done\";\ntype UseAddDocumentDispatcher = (\n  data: DocumentData,\n) => Promise<DocumentReference | undefined>;\n\ntype UseAddDocument = {\n  state: UseAddDocumentState;\n  dispatch: UseAddDocumentDispatcher;\n  reference?: DocumentReference;\n  error?: FirebaseError;\n};\n\nexport const useAddDocument = (\n  reference: CollectionReference,\n): UseAddDocument => {\n  const [state, setState] = useState<UseAddDocumentState>(\"ready\");\n  const [refer, setRefer] = useState<DocumentReference | undefined>();\n  const [error, setError] = useState<FirebaseError | undefined>();\n\n  const dispatch: UseAddDocumentDispatcher = async (data: DocumentData) => {\n    setState(\"loading\");\n\n    try {\n      const docRef = await addDoc(reference, data);\n      setRefer(docRef);\n      setState(\"done\");\n      return docRef;\n    } catch (error) {\n      if (error instanceof FirebaseError) {\n        setError(error);\n        setState(\"ready\");\n        return;\n      } else {\n        setState(\"ready\");\n        throw error;\n      }\n    }\n  };\n\n  return { state, dispatch, reference: refer, error };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FirebaseError } from \"firebase/app\";\nimport {\n  DocumentData,\n  DocumentReference,\n  SetOptions,\n  setDoc,\n} from \"firebase/firestore\";\nimport { useState } from \"react\";\n\ntype UseSetDocumentState = \"ready\" | \"loading\" | \"done\";\ntype UseSetDocumentDispatcher = (\n  data: DocumentData,\n  options?: SetOptions,\n) => Promise<void>;\n\ntype UseSetDocument = {\n  state: UseSetDocumentState;\n  dispatch: UseSetDocumentDispatcher;\n  error?: FirebaseError;\n};\n\nexport const useSetDocument = (\n  reference: DocumentReference,\n): UseSetDocument => {\n  const [state, setState] = useState<UseSetDocumentState>(\"ready\");\n  const [error, setError] = useState<FirebaseError | undefined>();\n\n  const dispatch: UseSetDocumentDispatcher = async (\n    data: DocumentData,\n    options,\n  ) => {\n    setState(\"loading\");\n    try {\n      await (options\n        ? setDoc(reference, data, options)\n        : setDoc(reference, data));\n      setState(\"done\");\n    } catch (e) {\n      if (e instanceof FirebaseError) {\n        setState(\"ready\");\n        setError(e);\n      } else {\n        setState(\"loading\");\n        throw e;\n      }\n      return;\n    }\n    setState(\"done\");\n  };\n\n  return { state, dispatch, error };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FirebaseError } from \"firebase/app\";\nimport { DocumentReference, deleteDoc } from \"firebase/firestore\";\nimport { useState } from \"react\";\n\ntype UseSetDocumentState = \"ready\" | \"loading\" | \"done\";\ntype UseSetDocumentDispatcher = () => Promise<void>;\n\ntype UseSetDocument = {\n  state: UseSetDocumentState;\n  dispatch: UseSetDocumentDispatcher;\n  error?: FirebaseError;\n};\n\nexport const useDeleteDocument = (\n  reference: DocumentReference,\n): UseSetDocument => {\n  const [state, setState] = useState<UseSetDocumentState>(\"ready\");\n  const [error, setError] = useState<FirebaseError | undefined>();\n\n  const dispatch: UseSetDocumentDispatcher = async () => {\n    setState(\"loading\");\n    try {\n      await deleteDoc(reference);\n      setState(\"done\");\n    } catch (e) {\n      if (e instanceof FirebaseError) {\n        setState(\"ready\");\n        setError(e);\n      } else {\n        setState(\"ready\");\n        throw e;\n      }\n    }\n  };\n\n  return { state, dispatch, error };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FirebaseError } from \"firebase/app\";\nimport { DocumentReference, DocumentSnapshot } from \"firebase/firestore\";\nimport { ReactNode } from \"react\";\nimport { useDocument } from \".\";\n\ntype FirestoreDocumentProps = {\n  reference: DocumentReference;\n  onLoading?: () => ReactNode;\n  onError?: (error: FirebaseError) => ReactNode;\n  onDone: (snapshot: DocumentSnapshot) => ReactNode;\n  listen?: boolean;\n};\n\nexport const FirestoreDocument = ({\n  reference,\n  onLoading = () => <></>,\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  onError = (_err) => <></>,\n  onDone,\n  listen = false,\n}: FirestoreDocumentProps) => {\n  const {\n    loading: processing,\n    snapshot,\n    error: err,\n  } = useDocument(reference, { listen });\n\n  return processing ? onLoading() : err ? onError(err) : onDone(snapshot!);\n};\n","import { FirebaseApp } from \"firebase/app\";\nimport { createContext } from \"react\";\nimport { NodeComponent } from \"../types\";\n\nexport const FirebaseAppContext = createContext<FirebaseApp | undefined>(\n  undefined,\n);\n\ntype FirebaseProviderProps = {\n  app: FirebaseApp;\n} & NodeComponent;\n\nexport const FirebaseProvider = ({ app, children }: FirebaseProviderProps) => {\n  return (\n    <FirebaseAppContext.Provider value={app}>\n      {children}\n    </FirebaseAppContext.Provider>\n  );\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { Firestore } from \"firebase/firestore\";\nimport { createContext } from \"react\";\nimport { NodeComponent } from \"../types\";\n\nexport const FirestoreContext = createContext<Firestore | undefined>(undefined);\n\ntype FirestoreProviderProps = {\n  firestore: Firestore;\n} & NodeComponent;\n\nexport const FirestoreProvider = ({\n  firestore,\n  children,\n}: FirestoreProviderProps) => {\n  return (\n    <FirestoreContext.Provider value={firestore}>\n      {children}\n    </FirestoreContext.Provider>\n  );\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { Auth } from \"firebase/auth\";\nimport { createContext } from \"react\";\nimport { NodeComponent } from \"../types\";\n\nexport const FirebaseAuthContext = createContext<Auth | undefined>(undefined);\n\ntype FirebaseAuthProviderProps = {\n  auth: Auth;\n} & NodeComponent;\n\nexport const FirebaseAuthProvider = ({\n  auth,\n  children,\n}: FirebaseAuthProviderProps) => {\n  return (\n    <FirebaseAuthContext.Provider value={auth}>\n      {children}\n    </FirebaseAuthContext.Provider>\n  );\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { Functions } from \"firebase/functions\";\nimport { createContext } from \"react\";\nimport { NodeComponent } from \"../types\";\n\nexport const FirebaseFunctionsContext = createContext<Functions | undefined>(\n  undefined,\n);\n\ntype FirebaseFunctionsProviderProps = {\n  functions: Functions;\n} & NodeComponent;\n\nexport const FirebaseFunctionsProvider = ({\n  functions,\n  children,\n}: FirebaseFunctionsProviderProps) => {\n  return (\n    <FirebaseFunctionsContext.Provider value={functions}>\n      {children}\n    </FirebaseFunctionsContext.Provider>\n  );\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FirebaseStorage } from \"firebase/storage\";\nimport { createContext } from \"react\";\nimport { NodeComponent } from \"../types\";\n\nexport const FirebaseStorageContext = createContext<\n  FirebaseStorage | undefined\n>(undefined);\n\ntype FirebaseStorageProviderProps = {\n  storage: FirebaseStorage;\n} & NodeComponent;\n\nexport const FirebaseStorageProvider = ({\n  storage,\n  children,\n}: FirebaseStorageProviderProps) => {\n  return (\n    <FirebaseStorageContext.Provider value={storage}>\n      {children}\n    </FirebaseStorageContext.Provider>\n  );\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport {\n  Auth,\n  CompleteFn,\n  ErrorFn,\n  User,\n  onAuthStateChanged,\n} from \"firebase/auth\";\nimport { useEffect, useState } from \"react\";\n\ntype UseAuthStateOptions = {\n  onError?: ErrorFn;\n  onChange?: CompleteFn;\n};\n\nexport const useUser = (\n  auth: Auth,\n  { onError, onChange }: UseAuthStateOptions = {\n    onError: () => {},\n    onChange: () => {},\n  },\n): User | null => {\n  const [user, setUser] = useState<User | null>(auth.currentUser);\n\n  useEffect(() => {\n    const unsub = onAuthStateChanged(\n      auth,\n      (user) => setUser(user),\n      onError,\n      onChange,\n    );\n    return unsub;\n  }, [auth, onError, onChange]);\n\n  return user;\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { Auth } from \"firebase/auth\";\nimport { useEffect, useState } from \"react\";\nimport { useUser } from \".\";\n\ntype UseSignOutParams = {\n  onError?: (error: Error) => void;\n  onlyRealAnon?: boolean;\n};\n\ntype UseSignOutState = \"ready\" | \"loading\" | \"anonymous\";\nexport type UseSignOutDispatcher = () => Promise<void>;\n\ntype UseSignOut = {\n  state: UseSignOutState;\n  dispatch: UseSignOutDispatcher;\n};\n\nexport const useSignOut = (\n  auth: Auth,\n  { onError, onlyRealAnon }: UseSignOutParams = {\n    onError: () => {},\n    onlyRealAnon: false,\n  },\n): UseSignOut => {\n  const [state, setState] = useState<UseSignOutState>(\"ready\");\n  const user = useUser(auth, { onError });\n\n  useEffect(() => {\n    // if (!user || user.isAnonymous) {\n    //   setState(\"anonymous\");\n    // }\n    if (onlyRealAnon) {\n      if (!user) {\n        setState(\"anonymous\");\n      }\n    } else {\n      if (!user || user.isAnonymous) {\n        setState(\"anonymous\");\n      }\n    }\n  }, [user, onlyRealAnon]);\n\n  const dispatch: UseSignOutDispatcher = async () => {\n    setState(\"loading\");\n    await auth.signOut();\n    setState(\"anonymous\");\n  };\n\n  return { state, dispatch: state === \"ready\" ? dispatch : async () => {} };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { Auth } from \"firebase/auth\";\nimport { ReactNode } from \"react\";\nimport { UseSignOutDispatcher, useSignOut } from \".\";\n\ntype SignOutProps = {\n  auth: Auth;\n  onlyRealAnon?: boolean;\n  onReady?: (dispatch: UseSignOutDispatcher) => ReactNode;\n  onLoading?: () => ReactNode;\n  onAnonymous?: () => ReactNode;\n};\n\nexport const SignOut = ({\n  auth,\n  onlyRealAnon = false,\n  onReady,\n  onLoading,\n  onAnonymous,\n}: SignOutProps) => {\n  const { state, dispatch } = useSignOut(auth, { onlyRealAnon });\n\n  switch (state) {\n    case \"ready\":\n      return onReady ? (\n        onReady(dispatch)\n      ) : (\n        <button onClick={dispatch}>Sign Out</button>\n      );\n    case \"loading\":\n      return onLoading ? onLoading() : <></>;\n    case \"anonymous\":\n      return onAnonymous ? onAnonymous() : <></>;\n  }\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport {\n  Auth,\n  UserCredential,\n  createUserWithEmailAndPassword,\n} from \"firebase/auth\";\nimport { useEffect, useState } from \"react\";\nimport { useUser } from \".\";\n\ntype UseSignUpState = \"ready\" | \"loading\" | \"authenticated\";\ntype UseSignUpDispatcher = (\n  email: string,\n  password: string,\n) => Promise<UserCredential | undefined>;\ntype UseSignUp = {\n  state: UseSignUpState;\n  dispatch: UseSignUpDispatcher;\n};\n\nexport const useSignUp = (auth: Auth): UseSignUp => {\n  const user = useUser(auth);\n  const [state, setState] = useState<UseSignUpState>(\"ready\");\n\n  useEffect(() => {\n    setState(user ? (user.isAnonymous ? \"ready\" : \"authenticated\") : \"ready\");\n  }, [user]);\n\n  const dispatch: UseSignUpDispatcher = async (email, password) => {\n    setState(\"loading\");\n    const credential = await createUserWithEmailAndPassword(\n      auth,\n      email,\n      password,\n    );\n    setState(\"authenticated\");\n    return credential;\n  };\n\n  return {\n    state,\n    dispatch: state === \"ready\" ? dispatch : async () => undefined,\n  };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { Auth, deleteUser, signOut } from \"firebase/auth\";\nimport { useEffect, useState } from \"react\";\nimport { useUser } from \".\";\n\ntype UseDeleteUserOptions = {\n  includeFirebaseAnon?: boolean;\n};\n\ntype UseDeleteUserState = \"ready\" | \"loading\" | \"anonymous\";\ntype UseDeleteUserDispatcher = () => Promise<void>;\ntype UseDeleteUser = {\n  state: UseDeleteUserState;\n  dispatch: UseDeleteUserDispatcher;\n};\n\nexport const useDeleteUser = (\n  auth: Auth,\n  { includeFirebaseAnon }: UseDeleteUserOptions = {\n    includeFirebaseAnon: false,\n  },\n): UseDeleteUser => {\n  const user = useUser(auth);\n  const [state, setState] = useState<UseDeleteUserState>(\"ready\");\n\n  useEffect(() => {\n    setState(\n      user\n        ? user.isAnonymous\n          ? includeFirebaseAnon\n            ? \"ready\"\n            : \"anonymous\"\n          : \"ready\"\n        : \"anonymous\",\n    );\n  }, [user, includeFirebaseAnon]);\n\n  const dispatch: UseDeleteUserDispatcher = async () => {\n    if (user) {\n      setState(\"loading\");\n      await deleteUser(user);\n      await signOut(auth);\n      setState(\"anonymous\");\n    }\n  };\n\n  return {\n    state,\n    dispatch: state === \"ready\" ? dispatch : async () => {},\n  };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { Auth, User } from \"firebase/auth\";\nimport { ReactNode, useEffect, useState } from \"react\";\nimport { useUser } from \".\";\n\nexport type AuthorizationZoneValidator = (\n  user: User | null,\n) => Promise<boolean> | boolean;\n\ntype AuthorizationZoneProps = {\n  auth: Auth;\n  validator?: AuthorizationZoneValidator;\n  onSuccess: (user: User | null) => ReactNode;\n  onFailure?: (user: User | null) => ReactNode;\n};\n\nexport const AuthorizationZone = ({\n  auth,\n  validator = Validators.isAuthenticated(),\n  onSuccess,\n  onFailure = () => <></>,\n}: AuthorizationZoneProps) => {\n  const user = useUser(auth);\n  const [success, setSuccess] = useState(false);\n\n  useEffect(() => {\n    const taskOrVal = validator(user);\n\n    if (taskOrVal instanceof Promise) {\n      taskOrVal.then(setSuccess);\n    } else {\n      setSuccess(taskOrVal);\n    }\n  }, [user, validator]);\n\n  return success ? onSuccess(user) : onFailure(user);\n};\n\nexport const Validators = {\n  isAuthenticated:\n    (includeFirebaseAnon = false) =>\n    (user: User | null) => {\n      return user ? (includeFirebaseAnon ? true : !user.isAnonymous) : false;\n    },\n  isAnonymous:\n    (excludeFirebaseAnon = false) =>\n    (user: User | null) =>\n      user ? (excludeFirebaseAnon ? false : user.isAnonymous) : true,\n  isVerified: () => (user: User | null) => user?.emailVerified ?? false,\n  every:\n    (validators: AuthorizationZoneValidator[]) =>\n    async (user: User | null): Promise<boolean> => {\n      const results = validators.map((v) => v(user));\n      const vals = results.filter((v) => typeof v === \"boolean\");\n      const tasks = results.filter((v) => v instanceof Promise);\n      const resolved = await Promise.all(tasks);\n      return [...vals, ...resolved].every((v) => v);\n    },\n  some:\n    (validators: AuthorizationZoneValidator[]) =>\n    async (user: User | null): Promise<boolean> => {\n      const results = validators.map((v) => v(user));\n      const vals = results.filter((v) => typeof v === \"boolean\");\n      const tasks = results.filter((v) => v instanceof Promise);\n      const resolved = await Promise.all(tasks);\n      return [...vals, ...resolved].some((v) => v);\n    },\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport {\n  Auth,\n  FacebookAuthProvider,\n  GithubAuthProvider,\n  GoogleAuthProvider,\n  OAuthProvider,\n  TwitterAuthProvider,\n  UserCredential,\n  sendSignInLinkToEmail,\n  signInWithEmailAndPassword,\n  signInWithPopup,\n} from \"@firebase/auth\";\nimport { ActionCodeSettings } from \"firebase/auth\";\nimport { useEffect, useState } from \"react\";\nimport { useUser } from \".\";\n\ntype UseSignInState = \"ready\" | \"loading\" | \"authenticated\" | \"awaiting\";\ntype UseSignInDispatcher = (\n  params:\n    | {\n        type: \"classic\";\n        email: string;\n        password: string;\n      }\n    | {\n        type: \"link\";\n        email: string;\n        actionCodeSetting: ActionCodeSettings;\n      }\n    | {\n        type: \"google\";\n        provider: GoogleAuthProvider;\n      }\n    | {\n        type: \"facebook\";\n        provider: FacebookAuthProvider;\n      }\n    | {\n        type: \"apple\" | \"microsoft\" | \"yahoo\";\n        provider: OAuthProvider;\n      }\n    | {\n        type: \"twitter\";\n        provider: TwitterAuthProvider;\n      }\n    | {\n        type: \"github\";\n        provider: GithubAuthProvider;\n      },\n) => Promise<UserCredential | undefined>;\ntype UseSignIn = {\n  state: UseSignInState;\n  dispatch: UseSignInDispatcher;\n};\n\nexport const useSignIn = (auth: Auth): UseSignIn => {\n  const user = useUser(auth);\n  const [state, setState] = useState<UseSignInState>(\"ready\");\n\n  useEffect(() => {\n    setState(user ? (user.isAnonymous ? \"ready\" : \"authenticated\") : \"ready\");\n    return () => setState(\"ready\");\n  }, [user]);\n\n  const dispatch: UseSignInDispatcher = async (params) => {\n    setState(\"loading\");\n    const { type } = params;\n\n    switch (type) {\n      case \"classic\": {\n        const { email, password } = params;\n        const credential = await signInWithEmailAndPassword(\n          auth,\n          email,\n          password,\n        );\n        setState(\"authenticated\");\n        return credential;\n      }\n      case \"link\": {\n        const { email, actionCodeSetting } = params;\n        await sendSignInLinkToEmail(auth, email, actionCodeSetting);\n        setState(\"awaiting\");\n        return undefined;\n      }\n      case \"google\": {\n        const { provider } = params;\n        const credential = await signInWithPopup(auth, provider);\n        setState(\"authenticated\");\n        setState(\"authenticated\");\n        return credential;\n      }\n      case \"facebook\": {\n        const { provider } = params;\n        const credential = await signInWithPopup(auth, provider);\n        setState(\"authenticated\");\n        setState(\"authenticated\");\n        return credential;\n      }\n      case \"apple\": {\n        const { provider } = params;\n        const credential = await signInWithPopup(auth, provider);\n        setState(\"authenticated\");\n        return credential;\n      }\n      case \"twitter\": {\n        const { provider } = params;\n        const credential = await signInWithPopup(auth, provider);\n        setState(\"authenticated\");\n        return credential;\n      }\n      case \"github\": {\n        const { provider } = params;\n        const credential = await signInWithPopup(auth, provider);\n        setState(\"authenticated\");\n        return credential;\n      }\n      case \"microsoft\": {\n        const { provider } = params;\n        const credential = await signInWithPopup(auth, provider);\n        setState(\"authenticated\");\n        return credential;\n      }\n      case \"yahoo\": {\n        const { provider } = params;\n        const credential = await signInWithPopup(auth, provider);\n        setState(\"authenticated\");\n        return credential;\n      }\n    }\n  };\n\n  return { state, dispatch };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { ActionCodeSettings, Auth, sendEmailVerification } from \"firebase/auth\";\nimport { useEffect, useState } from \"react\";\nimport { useUser } from \".\";\n\ntype UseSendEmailVerificationState = \"ready\" | \"loading\" | \"done\" | \"anonymous\";\ntype UseSendEmailVerificationDispatcher = (\n  actionCodeSettings?: ActionCodeSettings,\n) => Promise<void>;\ntype UseSendEmailVerification = {\n  state: UseSendEmailVerificationState;\n  dispatch: UseSendEmailVerificationDispatcher;\n};\n\nexport const useSendEmailVerification = (\n  auth: Auth,\n): UseSendEmailVerification => {\n  const user = useUser(auth);\n  const [state, setState] = useState<UseSendEmailVerificationState>(\"ready\");\n\n  useEffect(() => {\n    if (!user) {\n      setState(\"anonymous\");\n      return;\n    }\n  }, [user]);\n\n  const dispatch: UseSendEmailVerificationDispatcher = async (\n    actionCodeSetting,\n  ) => {\n    setState(\"loading\");\n    await sendEmailVerification(\n      user!, // guaranteed user not null on ready\n      actionCodeSetting,\n    );\n    setState(\"done\");\n  };\n\n  return { state, dispatch: state === \"ready\" ? dispatch : async () => {} };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport {\n  Functions,\n  HttpsCallableOptions,\n  HttpsCallableResult,\n  httpsCallable,\n} from \"firebase/functions\";\nimport { useState } from \"react\";\n\ntype UseCallFunctionOptions = {\n  name: string;\n  httpsCallableOptions?: HttpsCallableOptions;\n};\n\ntype UseCallFunctionState = \"ready\" | \"loading\" | \"done\";\ntype UseCallFunctionInvoker = (\n  data?: unknown,\n) => Promise<HttpsCallableResult<unknown>>;\ntype UseCallFunction = {\n  state: UseCallFunctionState;\n  invoke: UseCallFunctionInvoker;\n};\n\nexport const useCallFunction = (\n  functions: Functions,\n  { name, httpsCallableOptions }: UseCallFunctionOptions,\n): UseCallFunction => {\n  const [state, setState] = useState<UseCallFunctionState>(\"ready\");\n\n  const invoke: UseCallFunctionInvoker = async (data: unknown = {}) => {\n    setState(\"loading\");\n    const r = httpsCallable(functions, name, httpsCallableOptions).call(data);\n    setState(\"done\");\n    return r;\n  };\n\n  return { state, invoke };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport {\n  StorageReference,\n  UploadMetadata,\n  UploadResult,\n  uploadBytes,\n} from \"firebase/storage\";\nimport { useState } from \"react\";\n\ntype UseUploadFileState = \"ready\" | \"loading\" | \"done\";\ntype UseUploadFileDispatcher = (\n  file: Buffer | File | Blob,\n  metadata?: UploadMetadata,\n) => Promise<UploadResult>;\ntype UseUploadFile = {\n  state: UseUploadFileState;\n  dispatch: UseUploadFileDispatcher;\n};\n\nexport const useUploadFile = (reference: StorageReference): UseUploadFile => {\n  const [state, setState] = useState<UseUploadFileState>(\"ready\");\n\n  const dispatch: UseUploadFileDispatcher = async (file, metadata) => {\n    setState(\"loading\");\n    const result = await uploadBytes(reference, file, metadata);\n    setState(\"done\");\n    return result;\n  };\n\n  return { state, dispatch };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport {\n  StorageReference,\n  UploadMetadata,\n  UploadResult,\n  uploadBytesResumable,\n} from \"firebase/storage\";\nimport { useState } from \"react\";\n\ntype UseUploadFileResumableState = \"ready\" | [number, number] | \"done\";\ntype UseUploadFileResumableDispatcher = (\n  file: Buffer | File | Blob,\n  metadata?: UploadMetadata,\n) => Promise<UploadResult>;\ntype UseUploadFileResumable = {\n  state: UseUploadFileResumableState;\n  dispatch: UseUploadFileResumableDispatcher;\n};\n\nexport const useUploadFileResumable = (\n  reference: StorageReference,\n): UseUploadFileResumable => {\n  const [state, setState] = useState<UseUploadFileResumableState>(\"ready\");\n\n  const dispatch: UseUploadFileResumableDispatcher = async (file, metadata) => {\n    const task = uploadBytesResumable(reference, file, metadata);\n    task.on(\"state_changed\", (snapshot) => {\n      setState([snapshot.bytesTransferred, snapshot.totalBytes]);\n    });\n    const result = await task;\n    setState(\"done\");\n    return result;\n  };\n\n  return { state, dispatch };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { StorageReference, getDownloadURL } from \"firebase/storage\";\nimport { useState } from \"react\";\n\ntype UseDownloadLinkState = \"ready\" | \"loading\" | \"done\";\ntype UseDownloadLinkDispatcher = () => Promise<string>;\ntype UseDownloadLink = {\n  link: string | undefined;\n  state: UseDownloadLinkState;\n  dispatch: UseDownloadLinkDispatcher;\n};\n\nexport const useDownloadLink = (\n  reference: StorageReference,\n): UseDownloadLink => {\n  const [state, setState] = useState<UseDownloadLinkState>(\"ready\");\n  const [link, setLink] = useState<string | undefined>(undefined);\n\n  const dispatch: UseDownloadLinkDispatcher = async () => {\n    setState(\"loading\");\n    const url = await getDownloadURL(reference);\n    setState(\"done\");\n    setLink(link);\n    return url;\n  };\n\n  return { state, dispatch, link };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { StorageReference } from \"firebase/storage\";\nimport { ReactNode, useEffect } from \"react\";\nimport { useDownloadLink } from \".\";\n\ntype StorageDownloadLinkProps = {\n  reference: StorageReference;\n  onLoading?: () => ReactNode;\n  onDone: (link: string) => ReactNode;\n};\n\nexport const StorageDownloadLink = ({\n  reference,\n  onLoading = () => <></>,\n  onDone,\n}: StorageDownloadLinkProps) => {\n  const { link, state, dispatch } = useDownloadLink(reference);\n\n  useEffect(() => {\n    dispatch();\n  }, [dispatch]);\n\n  return state === \"done\" ? onDone(link!) : onLoading();\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { StorageReference, getBlob } from \"firebase/storage\";\nimport { useState } from \"react\";\n\ntype UseDownloadBlobState = \"ready\" | \"loading\" | \"done\";\ntype UseDownloadBlobDispatcher = (\n  maxDownloadSizeBytes?: number,\n) => Promise<Blob>;\ntype UseDownloadBlob = {\n  blob: Blob | undefined;\n  state: UseDownloadBlobState;\n  dispatch: UseDownloadBlobDispatcher;\n};\n\nexport const useDownloadBlob = (\n  reference: StorageReference,\n): UseDownloadBlob => {\n  const [state, setState] = useState<UseDownloadBlobState>(\"ready\");\n  const [blob, setBlob] = useState<Blob | undefined>(undefined);\n\n  const dispatch: UseDownloadBlobDispatcher = async (maxDownloadSizeBytes) => {\n    setState(\"loading\");\n    const blob = await getBlob(reference, maxDownloadSizeBytes);\n    setState(\"done\");\n    setBlob(blob);\n    return blob;\n  };\n\n  return { blob, state, dispatch };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { StorageReference, getBytes } from \"firebase/storage\";\nimport { useState } from \"react\";\n\ntype UseDownloadBytesState = \"ready\" | \"loading\" | \"done\";\ntype UseDownloadBytesDispatcher = (\n  maxDownloadSizeBytes?: number,\n) => Promise<ArrayBuffer>;\ntype UseDownloadBytes = {\n  bytes: ArrayBuffer | undefined;\n  state: UseDownloadBytesState;\n  dispatch: UseDownloadBytesDispatcher;\n};\n\nexport const useDownloadBytes = (\n  reference: StorageReference,\n): UseDownloadBytes => {\n  const [state, setState] = useState<UseDownloadBytesState>(\"ready\");\n  const [bytes, setBytes] = useState<ArrayBuffer | undefined>(undefined);\n\n  const dispatch: UseDownloadBytesDispatcher = async (maxDownloadSizeBytes) => {\n    setState(\"loading\");\n    const bytes = await getBytes(reference, maxDownloadSizeBytes);\n    setState(\"done\");\n    setBytes(bytes);\n    return bytes;\n  };\n\n  return { bytes, state, dispatch };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { StorageReference, deleteObject } from \"firebase/storage\";\nimport { useState } from \"react\";\n\ntype UseDeleteFileState = \"ready\" | \"loading\" | \"done\";\ntype UseDeleteFileDispatcher = () => Promise<void>;\ntype UseDeleteFile = {\n  state: UseDeleteFileState;\n  dispatch: UseDeleteFileDispatcher;\n};\n\nexport const useDeleteFile = (reference: StorageReference): UseDeleteFile => {\n  const [state, setState] = useState<UseDeleteFileState>(\"ready\");\n\n  const dispatch: UseDeleteFileDispatcher = async () => {\n    setState(\"loading\");\n    await deleteObject(reference);\n    setState(\"done\");\n  };\n\n  return { state, dispatch };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FullMetadata, StorageReference, getMetadata } from \"firebase/storage\";\nimport { useState } from \"react\";\n\ntype UseFileMetadataState = \"ready\" | \"loading\" | \"done\";\ntype UseFileMetadataDispatcher = () => Promise<FullMetadata>;\ntype UseFileMetadata = {\n  metadata: FullMetadata | undefined;\n  state: UseFileMetadataState;\n  dispatch: UseFileMetadataDispatcher;\n};\n\nexport const useFileMetadata = (\n  reference: StorageReference,\n): UseFileMetadata => {\n  const [state, setState] = useState<UseFileMetadataState>(\"ready\");\n  const [metadata, setMetadata] = useState<FullMetadata | undefined>(undefined);\n\n  const dispatch: UseFileMetadataDispatcher = async () => {\n    setState(\"loading\");\n    const metadata = await getMetadata(reference);\n    setState(\"done\");\n    setMetadata(metadata);\n    return metadata;\n  };\n\n  return { metadata, state, dispatch };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FullMetadata, StorageReference } from \"firebase/storage\";\nimport { ReactNode, useEffect } from \"react\";\nimport { useFileMetadata } from \".\";\n\ntype StorageMetadataProps = {\n  reference: StorageReference;\n  onLoading?: () => ReactNode;\n  onDone: (metadata: FullMetadata) => ReactNode;\n};\n\nexport const StorageMetadata = ({\n  reference,\n  onLoading = () => <></>,\n  onDone,\n}: StorageMetadataProps) => {\n  const { metadata, state, dispatch } = useFileMetadata(reference);\n\n  useEffect(() => {\n    dispatch();\n  }, [dispatch]);\n\n  return state === \"done\" ? onDone(metadata!) : onLoading();\n};\n"],"names":["useCollection","query","listen","listenToMetadataChanges","loading","setLoading","useState","snapshot","setSnapshot","error","setError","useEffect","onSnapshot","snap","getDocs","qSnapshot","e","FirebaseError","useDocument","reference","getDoc","useAddDocument","state","setState","refer","setRefer","data","docRef","addDoc","useSetDocument","options","setDoc","useDeleteDocument","deleteDoc","FirestoreDocument","onLoading","jsx","Fragment","onError","_err","onDone","processing","err","FirebaseAppContext","createContext","FirebaseProvider","app","children","FirestoreContext","FirestoreProvider","firestore","FirebaseAuthContext","FirebaseAuthProvider","auth","FirebaseFunctionsContext","FirebaseFunctionsProvider","functions","FirebaseStorageContext","FirebaseStorageProvider","storage","useUser","onChange","user","setUser","onAuthStateChanged","useSignOut","onlyRealAnon","SignOut","onReady","onAnonymous","dispatch","useSignUp","email","password","credential","createUserWithEmailAndPassword","useDeleteUser","includeFirebaseAnon","deleteUser","signOut","AuthorizationZone","validator","Validators","onSuccess","onFailure","success","setSuccess","taskOrVal","excludeFirebaseAnon","validators","results","v","vals","tasks","resolved","useSignIn","params","type","signInWithEmailAndPassword","actionCodeSetting","sendSignInLinkToEmail","provider","signInWithPopup","useSendEmailVerification","sendEmailVerification","useCallFunction","name","httpsCallableOptions","r","httpsCallable","useUploadFile","file","metadata","result","uploadBytes","useUploadFileResumable","task","uploadBytesResumable","useDownloadLink","link","setLink","url","getDownloadURL","StorageDownloadLink","useDownloadBlob","blob","setBlob","maxDownloadSizeBytes","getBlob","useDownloadBytes","bytes","setBytes","getBytes","useDeleteFile","deleteObject","useFileMetadata","setMetadata","getMetadata","StorageMetadata"],"mappings":"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"}