{"version":3,"file":"index.cjs.js","sources":["../src/firestore/useCollection.ts","../src/firestore/useDocument.ts","../src/firestore/useAddDocument.ts","../src/firestore/useSetDocument.ts","../src/firestore/useDeleteDocument.ts","../src/firestore/FirestoreDocument.tsx","../src/providers/FirebaseProvider.tsx","../src/providers/FirestoreProvider.tsx","../src/providers/FirebaseAuthProvider.tsx","../src/providers/FirebaseFunctionsProvider.tsx","../src/providers/FirebaseStorageProvider.tsx","../src/auth/useUser.ts","../src/auth/useSignOut.ts","../src/auth/SignOut.tsx","../src/auth/useSignUp.ts","../src/auth/useDeleteUser.ts","../src/auth/AuthorizationZone.tsx","../src/auth/useSignIn.ts","../src/auth/useSendEmailVerification.ts","../src/functions/useCallFunction.ts","../src/storage/useUploadFile.ts","../src/storage/useUploadFileResumable.ts","../src/storage/useDownloadLink.ts","../src/storage/StorageDownloadLink.tsx","../src/storage/useDownloadBlob.ts","../src/storage/useDownloadBytes.ts","../src/storage/useDeleteFile.ts","../src/storage/useFileMetadata.ts","../src/storage/StorageMetadata.tsx"],"sourcesContent":["// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FirebaseError } from \"firebase/app\";\nimport { Query, QuerySnapshot, getDocs, onSnapshot } from \"firebase/firestore\";\nimport { useEffect, useState } from \"react\";\n\ntype UseCollectionOptions = {\n  listen?: boolean;\n  listenToMetadataChanges?: boolean;\n};\n\ntype UseCollection = {\n  loading: boolean;\n  snapshot?: QuerySnapshot;\n  error?: FirebaseError;\n};\n\nexport const useCollection = (\n  query: Query,\n  { listen, listenToMetadataChanges }: UseCollectionOptions = {\n    listen: false,\n    listenToMetadataChanges: false,\n  },\n): UseCollection => {\n  const [loading, setLoading] = useState<boolean>(true);\n  const [snapshot, setSnapshot] = useState<QuerySnapshot | undefined>();\n  const [error, setError] = useState<FirebaseError | undefined>();\n\n  useEffect(() => {\n    setLoading(true);\n\n    if (listen) {\n      const unsub = onSnapshot(\n        query,\n        { includeMetadataChanges: listenToMetadataChanges },\n        (snap) => {\n          setSnapshot(snap);\n          setLoading(false);\n        },\n        (error) => setError(error),\n        () => setLoading(false),\n      );\n      return unsub;\n    } else {\n      getDocs(query)\n        .then((qSnapshot) => {\n          setSnapshot(qSnapshot);\n          setLoading(false);\n        })\n        .catch((e) => {\n          if (e instanceof FirebaseError) {\n            setError(e);\n            setLoading(false);\n          } else {\n            setLoading(false);\n            throw e;\n          }\n        })\n        .finally(() => setLoading(false));\n    }\n  }, [query, listen, listenToMetadataChanges]);\n\n  return { loading, snapshot, error };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FirebaseError } from \"firebase/app\";\nimport {\n  DocumentReference,\n  DocumentSnapshot,\n  getDoc,\n  onSnapshot,\n} from \"firebase/firestore\";\nimport { useEffect, useState } from \"react\";\n\ntype UseDocumentOptions = {\n  listen?: boolean;\n  listenToMetadataChanges?: boolean;\n};\n\ntype UseDocument = {\n  loading: boolean;\n  snapshot?: DocumentSnapshot;\n  error?: FirebaseError;\n};\n\nexport const useDocument = (\n  reference: DocumentReference,\n  { listen, listenToMetadataChanges }: UseDocumentOptions = {\n    listen: true,\n    listenToMetadataChanges: false,\n  },\n): UseDocument => {\n  const [loading, setLoading] = useState<boolean>(true);\n  const [snapshot, setSnapshot] = useState<DocumentSnapshot | undefined>();\n  const [error, setError] = useState<FirebaseError | undefined>();\n\n  useEffect(() => {\n    setLoading(true);\n    if (listen) {\n      const unsub = onSnapshot(\n        reference,\n        { includeMetadataChanges: listenToMetadataChanges },\n        (snap) => {\n          setSnapshot(snap);\n          setLoading(false);\n        },\n        (error) => setError(error),\n        () => setLoading(false),\n      );\n      return unsub;\n    } else {\n      getDoc(reference)\n        .then((snapshot) => {\n          setSnapshot(snapshot);\n          setLoading(false);\n        })\n        .catch((e) => {\n          if (e instanceof FirebaseError) {\n            setError(e);\n            setLoading(false);\n          } else {\n            setLoading(false);\n            throw e;\n          }\n        })\n        .finally(() => setLoading(false));\n    }\n  }, [reference, listen, listenToMetadataChanges]);\n\n  return { loading, snapshot, error };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FirebaseError } from \"firebase/app\";\nimport {\n  CollectionReference,\n  DocumentData,\n  DocumentReference,\n  addDoc,\n} from \"firebase/firestore\";\nimport { useState } from \"react\";\n\ntype UseAddDocumentState = \"ready\" | \"loading\" | \"done\";\ntype UseAddDocumentDispatcher = (\n  data: DocumentData,\n) => Promise<DocumentReference | undefined>;\n\ntype UseAddDocument = {\n  state: UseAddDocumentState;\n  dispatch: UseAddDocumentDispatcher;\n  reference?: DocumentReference;\n  error?: FirebaseError;\n};\n\nexport const useAddDocument = (\n  reference: CollectionReference,\n): UseAddDocument => {\n  const [state, setState] = useState<UseAddDocumentState>(\"ready\");\n  const [refer, setRefer] = useState<DocumentReference | undefined>();\n  const [error, setError] = useState<FirebaseError | undefined>();\n\n  const dispatch: UseAddDocumentDispatcher = async (data: DocumentData) => {\n    setState(\"loading\");\n\n    try {\n      const docRef = await addDoc(reference, data);\n      setRefer(docRef);\n      setState(\"done\");\n      return docRef;\n    } catch (error) {\n      if (error instanceof FirebaseError) {\n        setError(error);\n        setState(\"ready\");\n        return;\n      } else {\n        setState(\"ready\");\n        throw error;\n      }\n    }\n  };\n\n  return { state, dispatch, reference: refer, error };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FirebaseError } from \"firebase/app\";\nimport {\n  DocumentData,\n  DocumentReference,\n  SetOptions,\n  setDoc,\n} from \"firebase/firestore\";\nimport { useState } from \"react\";\n\ntype UseSetDocumentState = \"ready\" | \"loading\" | \"done\";\ntype UseSetDocumentDispatcher = (\n  data: DocumentData,\n  options?: SetOptions,\n) => Promise<void>;\n\ntype UseSetDocument = {\n  state: UseSetDocumentState;\n  dispatch: UseSetDocumentDispatcher;\n  error?: FirebaseError;\n};\n\nexport const useSetDocument = (\n  reference: DocumentReference,\n): UseSetDocument => {\n  const [state, setState] = useState<UseSetDocumentState>(\"ready\");\n  const [error, setError] = useState<FirebaseError | undefined>();\n\n  const dispatch: UseSetDocumentDispatcher = async (\n    data: DocumentData,\n    options,\n  ) => {\n    setState(\"loading\");\n    try {\n      await (options\n        ? setDoc(reference, data, options)\n        : setDoc(reference, data));\n      setState(\"done\");\n    } catch (e) {\n      if (e instanceof FirebaseError) {\n        setState(\"ready\");\n        setError(e);\n      } else {\n        setState(\"loading\");\n        throw e;\n      }\n      return;\n    }\n    setState(\"done\");\n  };\n\n  return { state, dispatch, error };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FirebaseError } from \"firebase/app\";\nimport { DocumentReference, deleteDoc } from \"firebase/firestore\";\nimport { useState } from \"react\";\n\ntype UseSetDocumentState = \"ready\" | \"loading\" | \"done\";\ntype UseSetDocumentDispatcher = () => Promise<void>;\n\ntype UseSetDocument = {\n  state: UseSetDocumentState;\n  dispatch: UseSetDocumentDispatcher;\n  error?: FirebaseError;\n};\n\nexport const useDeleteDocument = (\n  reference: DocumentReference,\n): UseSetDocument => {\n  const [state, setState] = useState<UseSetDocumentState>(\"ready\");\n  const [error, setError] = useState<FirebaseError | undefined>();\n\n  const dispatch: UseSetDocumentDispatcher = async () => {\n    setState(\"loading\");\n    try {\n      await deleteDoc(reference);\n      setState(\"done\");\n    } catch (e) {\n      if (e instanceof FirebaseError) {\n        setState(\"ready\");\n        setError(e);\n      } else {\n        setState(\"ready\");\n        throw e;\n      }\n    }\n  };\n\n  return { state, dispatch, error };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FirebaseError } from \"firebase/app\";\nimport { DocumentReference, DocumentSnapshot } from \"firebase/firestore\";\nimport { ReactNode } from \"react\";\nimport { useDocument } from \".\";\n\ntype FirestoreDocumentProps = {\n  reference: DocumentReference;\n  onLoading?: () => ReactNode;\n  onError?: (error: FirebaseError) => ReactNode;\n  onDone: (snapshot: DocumentSnapshot) => ReactNode;\n  listen?: boolean;\n};\n\nexport const FirestoreDocument = ({\n  reference,\n  onLoading = () => <></>,\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  onError = (_err) => <></>,\n  onDone,\n  listen = false,\n}: FirestoreDocumentProps) => {\n  const {\n    loading: processing,\n    snapshot,\n    error: err,\n  } = useDocument(reference, { listen });\n\n  return processing ? onLoading() : err ? onError(err) : onDone(snapshot!);\n};\n","import { FirebaseApp } from \"firebase/app\";\nimport { createContext } from \"react\";\nimport { NodeComponent } from \"../types\";\n\nexport const FirebaseAppContext = createContext<FirebaseApp | undefined>(\n  undefined,\n);\n\ntype FirebaseProviderProps = {\n  app: FirebaseApp;\n} & NodeComponent;\n\nexport const FirebaseProvider = ({ app, children }: FirebaseProviderProps) => {\n  return (\n    <FirebaseAppContext.Provider value={app}>\n      {children}\n    </FirebaseAppContext.Provider>\n  );\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { Firestore } from \"firebase/firestore\";\nimport { createContext } from \"react\";\nimport { NodeComponent } from \"../types\";\n\nexport const FirestoreContext = createContext<Firestore | undefined>(undefined);\n\ntype FirestoreProviderProps = {\n  firestore: Firestore;\n} & NodeComponent;\n\nexport const FirestoreProvider = ({\n  firestore,\n  children,\n}: FirestoreProviderProps) => {\n  return (\n    <FirestoreContext.Provider value={firestore}>\n      {children}\n    </FirestoreContext.Provider>\n  );\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { Auth } from \"firebase/auth\";\nimport { createContext } from \"react\";\nimport { NodeComponent } from \"../types\";\n\nexport const FirebaseAuthContext = createContext<Auth | undefined>(undefined);\n\ntype FirebaseAuthProviderProps = {\n  auth: Auth;\n} & NodeComponent;\n\nexport const FirebaseAuthProvider = ({\n  auth,\n  children,\n}: FirebaseAuthProviderProps) => {\n  return (\n    <FirebaseAuthContext.Provider value={auth}>\n      {children}\n    </FirebaseAuthContext.Provider>\n  );\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { Functions } from \"firebase/functions\";\nimport { createContext } from \"react\";\nimport { NodeComponent } from \"../types\";\n\nexport const FirebaseFunctionsContext = createContext<Functions | undefined>(\n  undefined,\n);\n\ntype FirebaseFunctionsProviderProps = {\n  functions: Functions;\n} & NodeComponent;\n\nexport const FirebaseFunctionsProvider = ({\n  functions,\n  children,\n}: FirebaseFunctionsProviderProps) => {\n  return (\n    <FirebaseFunctionsContext.Provider value={functions}>\n      {children}\n    </FirebaseFunctionsContext.Provider>\n  );\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FirebaseStorage } from \"firebase/storage\";\nimport { createContext } from \"react\";\nimport { NodeComponent } from \"../types\";\n\nexport const FirebaseStorageContext = createContext<\n  FirebaseStorage | undefined\n>(undefined);\n\ntype FirebaseStorageProviderProps = {\n  storage: FirebaseStorage;\n} & NodeComponent;\n\nexport const FirebaseStorageProvider = ({\n  storage,\n  children,\n}: FirebaseStorageProviderProps) => {\n  return (\n    <FirebaseStorageContext.Provider value={storage}>\n      {children}\n    </FirebaseStorageContext.Provider>\n  );\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport {\n  Auth,\n  CompleteFn,\n  ErrorFn,\n  User,\n  onAuthStateChanged,\n} from \"firebase/auth\";\nimport { useEffect, useState } from \"react\";\n\ntype UseAuthStateOptions = {\n  onError?: ErrorFn;\n  onChange?: CompleteFn;\n};\n\nexport const useUser = (\n  auth: Auth,\n  { onError, onChange }: UseAuthStateOptions = {\n    onError: () => {},\n    onChange: () => {},\n  },\n): User | null => {\n  const [user, setUser] = useState<User | null>(auth.currentUser);\n\n  useEffect(() => {\n    const unsub = onAuthStateChanged(\n      auth,\n      (user) => setUser(user),\n      onError,\n      onChange,\n    );\n    return unsub;\n  }, [auth, onError, onChange]);\n\n  return user;\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { Auth } from \"firebase/auth\";\nimport { useEffect, useState } from \"react\";\nimport { useUser } from \".\";\n\ntype UseSignOutParams = {\n  onError?: (error: Error) => void;\n  onlyRealAnon?: boolean;\n};\n\ntype UseSignOutState = \"ready\" | \"loading\" | \"anonymous\";\nexport type UseSignOutDispatcher = () => Promise<void>;\n\ntype UseSignOut = {\n  state: UseSignOutState;\n  dispatch: UseSignOutDispatcher;\n};\n\nexport const useSignOut = (\n  auth: Auth,\n  { onError, onlyRealAnon }: UseSignOutParams = {\n    onError: () => {},\n    onlyRealAnon: false,\n  },\n): UseSignOut => {\n  const [state, setState] = useState<UseSignOutState>(\"ready\");\n  const user = useUser(auth, { onError });\n\n  useEffect(() => {\n    // if (!user || user.isAnonymous) {\n    //   setState(\"anonymous\");\n    // }\n    if (onlyRealAnon) {\n      if (!user) {\n        setState(\"anonymous\");\n      }\n    } else {\n      if (!user || user.isAnonymous) {\n        setState(\"anonymous\");\n      }\n    }\n  }, [user, onlyRealAnon]);\n\n  const dispatch: UseSignOutDispatcher = async () => {\n    setState(\"loading\");\n    await auth.signOut();\n    setState(\"anonymous\");\n  };\n\n  return { state, dispatch: state === \"ready\" ? dispatch : async () => {} };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { Auth } from \"firebase/auth\";\nimport { ReactNode } from \"react\";\nimport { UseSignOutDispatcher, useSignOut } from \".\";\n\ntype SignOutProps = {\n  auth: Auth;\n  onlyRealAnon?: boolean;\n  onReady?: (dispatch: UseSignOutDispatcher) => ReactNode;\n  onLoading?: () => ReactNode;\n  onAnonymous?: () => ReactNode;\n};\n\nexport const SignOut = ({\n  auth,\n  onlyRealAnon = false,\n  onReady,\n  onLoading,\n  onAnonymous,\n}: SignOutProps) => {\n  const { state, dispatch } = useSignOut(auth, { onlyRealAnon });\n\n  switch (state) {\n    case \"ready\":\n      return onReady ? (\n        onReady(dispatch)\n      ) : (\n        <button onClick={dispatch}>Sign Out</button>\n      );\n    case \"loading\":\n      return onLoading ? onLoading() : <></>;\n    case \"anonymous\":\n      return onAnonymous ? onAnonymous() : <></>;\n  }\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport {\n  Auth,\n  UserCredential,\n  createUserWithEmailAndPassword,\n} from \"firebase/auth\";\nimport { useEffect, useState } from \"react\";\nimport { useUser } from \".\";\n\ntype UseSignUpState = \"ready\" | \"loading\" | \"authenticated\";\ntype UseSignUpDispatcher = (\n  email: string,\n  password: string,\n) => Promise<UserCredential | undefined>;\ntype UseSignUp = {\n  state: UseSignUpState;\n  dispatch: UseSignUpDispatcher;\n};\n\nexport const useSignUp = (auth: Auth): UseSignUp => {\n  const user = useUser(auth);\n  const [state, setState] = useState<UseSignUpState>(\"ready\");\n\n  useEffect(() => {\n    setState(user ? (user.isAnonymous ? \"ready\" : \"authenticated\") : \"ready\");\n  }, [user]);\n\n  const dispatch: UseSignUpDispatcher = async (email, password) => {\n    setState(\"loading\");\n    const credential = await createUserWithEmailAndPassword(\n      auth,\n      email,\n      password,\n    );\n    setState(\"authenticated\");\n    return credential;\n  };\n\n  return {\n    state,\n    dispatch: state === \"ready\" ? dispatch : async () => undefined,\n  };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { Auth, deleteUser, signOut } from \"firebase/auth\";\nimport { useEffect, useState } from \"react\";\nimport { useUser } from \".\";\n\ntype UseDeleteUserOptions = {\n  includeFirebaseAnon?: boolean;\n};\n\ntype UseDeleteUserState = \"ready\" | \"loading\" | \"anonymous\";\ntype UseDeleteUserDispatcher = () => Promise<void>;\ntype UseDeleteUser = {\n  state: UseDeleteUserState;\n  dispatch: UseDeleteUserDispatcher;\n};\n\nexport const useDeleteUser = (\n  auth: Auth,\n  { includeFirebaseAnon }: UseDeleteUserOptions = {\n    includeFirebaseAnon: false,\n  },\n): UseDeleteUser => {\n  const user = useUser(auth);\n  const [state, setState] = useState<UseDeleteUserState>(\"ready\");\n\n  useEffect(() => {\n    setState(\n      user\n        ? user.isAnonymous\n          ? includeFirebaseAnon\n            ? \"ready\"\n            : \"anonymous\"\n          : \"ready\"\n        : \"anonymous\",\n    );\n  }, [user, includeFirebaseAnon]);\n\n  const dispatch: UseDeleteUserDispatcher = async () => {\n    if (user) {\n      setState(\"loading\");\n      await deleteUser(user);\n      await signOut(auth);\n      setState(\"anonymous\");\n    }\n  };\n\n  return {\n    state,\n    dispatch: state === \"ready\" ? dispatch : async () => {},\n  };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { Auth, User } from \"firebase/auth\";\nimport { ReactNode, useEffect, useState } from \"react\";\nimport { useUser } from \".\";\n\nexport type AuthorizationZoneValidator = (\n  user: User | null,\n) => Promise<boolean> | boolean;\n\ntype AuthorizationZoneProps = {\n  auth: Auth;\n  validator?: AuthorizationZoneValidator;\n  onSuccess: (user: User | null) => ReactNode;\n  onFailure?: (user: User | null) => ReactNode;\n};\n\nexport const AuthorizationZone = ({\n  auth,\n  validator = Validators.isAuthenticated(),\n  onSuccess,\n  onFailure = () => <></>,\n}: AuthorizationZoneProps) => {\n  const user = useUser(auth);\n  const [success, setSuccess] = useState(false);\n\n  useEffect(() => {\n    const taskOrVal = validator(user);\n\n    if (taskOrVal instanceof Promise) {\n      taskOrVal.then(setSuccess);\n    } else {\n      setSuccess(taskOrVal);\n    }\n  }, [user, validator]);\n\n  return success ? onSuccess(user) : onFailure(user);\n};\n\nexport const Validators = {\n  isAuthenticated:\n    (includeFirebaseAnon = false) =>\n    (user: User | null) => {\n      return user ? (includeFirebaseAnon ? true : !user.isAnonymous) : false;\n    },\n  isAnonymous:\n    (excludeFirebaseAnon = false) =>\n    (user: User | null) =>\n      user ? (excludeFirebaseAnon ? false : user.isAnonymous) : true,\n  isVerified: () => (user: User | null) => user?.emailVerified ?? false,\n  every:\n    (validators: AuthorizationZoneValidator[]) =>\n    async (user: User | null): Promise<boolean> => {\n      const results = validators.map((v) => v(user));\n      const vals = results.filter((v) => typeof v === \"boolean\");\n      const tasks = results.filter((v) => v instanceof Promise);\n      const resolved = await Promise.all(tasks);\n      return [...vals, ...resolved].every((v) => v);\n    },\n  some:\n    (validators: AuthorizationZoneValidator[]) =>\n    async (user: User | null): Promise<boolean> => {\n      const results = validators.map((v) => v(user));\n      const vals = results.filter((v) => typeof v === \"boolean\");\n      const tasks = results.filter((v) => v instanceof Promise);\n      const resolved = await Promise.all(tasks);\n      return [...vals, ...resolved].some((v) => v);\n    },\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport {\n  Auth,\n  FacebookAuthProvider,\n  GithubAuthProvider,\n  GoogleAuthProvider,\n  OAuthProvider,\n  TwitterAuthProvider,\n  UserCredential,\n  sendSignInLinkToEmail,\n  signInWithEmailAndPassword,\n  signInWithPopup,\n} from \"@firebase/auth\";\nimport { ActionCodeSettings } from \"firebase/auth\";\nimport { useEffect, useState } from \"react\";\nimport { useUser } from \".\";\n\ntype UseSignInState = \"ready\" | \"loading\" | \"authenticated\" | \"awaiting\";\ntype UseSignInDispatcher = (\n  params:\n    | {\n        type: \"classic\";\n        email: string;\n        password: string;\n      }\n    | {\n        type: \"link\";\n        email: string;\n        actionCodeSetting: ActionCodeSettings;\n      }\n    | {\n        type: \"google\";\n        provider: GoogleAuthProvider;\n      }\n    | {\n        type: \"facebook\";\n        provider: FacebookAuthProvider;\n      }\n    | {\n        type: \"apple\" | \"microsoft\" | \"yahoo\";\n        provider: OAuthProvider;\n      }\n    | {\n        type: \"twitter\";\n        provider: TwitterAuthProvider;\n      }\n    | {\n        type: \"github\";\n        provider: GithubAuthProvider;\n      },\n) => Promise<UserCredential | undefined>;\ntype UseSignIn = {\n  state: UseSignInState;\n  dispatch: UseSignInDispatcher;\n};\n\nexport const useSignIn = (auth: Auth): UseSignIn => {\n  const user = useUser(auth);\n  const [state, setState] = useState<UseSignInState>(\"ready\");\n\n  useEffect(() => {\n    setState(user ? (user.isAnonymous ? \"ready\" : \"authenticated\") : \"ready\");\n    return () => setState(\"ready\");\n  }, [user]);\n\n  const dispatch: UseSignInDispatcher = async (params) => {\n    setState(\"loading\");\n    const { type } = params;\n\n    switch (type) {\n      case \"classic\": {\n        const { email, password } = params;\n        const credential = await signInWithEmailAndPassword(\n          auth,\n          email,\n          password,\n        );\n        setState(\"authenticated\");\n        return credential;\n      }\n      case \"link\": {\n        const { email, actionCodeSetting } = params;\n        await sendSignInLinkToEmail(auth, email, actionCodeSetting);\n        setState(\"awaiting\");\n        return undefined;\n      }\n      case \"google\": {\n        const { provider } = params;\n        const credential = await signInWithPopup(auth, provider);\n        setState(\"authenticated\");\n        setState(\"authenticated\");\n        return credential;\n      }\n      case \"facebook\": {\n        const { provider } = params;\n        const credential = await signInWithPopup(auth, provider);\n        setState(\"authenticated\");\n        setState(\"authenticated\");\n        return credential;\n      }\n      case \"apple\": {\n        const { provider } = params;\n        const credential = await signInWithPopup(auth, provider);\n        setState(\"authenticated\");\n        return credential;\n      }\n      case \"twitter\": {\n        const { provider } = params;\n        const credential = await signInWithPopup(auth, provider);\n        setState(\"authenticated\");\n        return credential;\n      }\n      case \"github\": {\n        const { provider } = params;\n        const credential = await signInWithPopup(auth, provider);\n        setState(\"authenticated\");\n        return credential;\n      }\n      case \"microsoft\": {\n        const { provider } = params;\n        const credential = await signInWithPopup(auth, provider);\n        setState(\"authenticated\");\n        return credential;\n      }\n      case \"yahoo\": {\n        const { provider } = params;\n        const credential = await signInWithPopup(auth, provider);\n        setState(\"authenticated\");\n        return credential;\n      }\n    }\n  };\n\n  return { state, dispatch };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { ActionCodeSettings, Auth, sendEmailVerification } from \"firebase/auth\";\nimport { useEffect, useState } from \"react\";\nimport { useUser } from \".\";\n\ntype UseSendEmailVerificationState = \"ready\" | \"loading\" | \"done\" | \"anonymous\";\ntype UseSendEmailVerificationDispatcher = (\n  actionCodeSettings?: ActionCodeSettings,\n) => Promise<void>;\ntype UseSendEmailVerification = {\n  state: UseSendEmailVerificationState;\n  dispatch: UseSendEmailVerificationDispatcher;\n};\n\nexport const useSendEmailVerification = (\n  auth: Auth,\n): UseSendEmailVerification => {\n  const user = useUser(auth);\n  const [state, setState] = useState<UseSendEmailVerificationState>(\"ready\");\n\n  useEffect(() => {\n    if (!user) {\n      setState(\"anonymous\");\n      return;\n    }\n  }, [user]);\n\n  const dispatch: UseSendEmailVerificationDispatcher = async (\n    actionCodeSetting,\n  ) => {\n    setState(\"loading\");\n    await sendEmailVerification(\n      user!, // guaranteed user not null on ready\n      actionCodeSetting,\n    );\n    setState(\"done\");\n  };\n\n  return { state, dispatch: state === \"ready\" ? dispatch : async () => {} };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport {\n  Functions,\n  HttpsCallableOptions,\n  HttpsCallableResult,\n  httpsCallable,\n} from \"firebase/functions\";\nimport { useState } from \"react\";\n\ntype UseCallFunctionOptions = {\n  name: string;\n  httpsCallableOptions?: HttpsCallableOptions;\n};\n\ntype UseCallFunctionState = \"ready\" | \"loading\" | \"done\";\ntype UseCallFunctionInvoker = (\n  data?: unknown,\n) => Promise<HttpsCallableResult<unknown>>;\ntype UseCallFunction = {\n  state: UseCallFunctionState;\n  invoke: UseCallFunctionInvoker;\n};\n\nexport const useCallFunction = (\n  functions: Functions,\n  { name, httpsCallableOptions }: UseCallFunctionOptions,\n): UseCallFunction => {\n  const [state, setState] = useState<UseCallFunctionState>(\"ready\");\n\n  const invoke: UseCallFunctionInvoker = async (data: unknown = {}) => {\n    setState(\"loading\");\n    const r = httpsCallable(functions, name, httpsCallableOptions).call(data);\n    setState(\"done\");\n    return r;\n  };\n\n  return { state, invoke };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport {\n  StorageReference,\n  UploadMetadata,\n  UploadResult,\n  uploadBytes,\n} from \"firebase/storage\";\nimport { useState } from \"react\";\n\ntype UseUploadFileState = \"ready\" | \"loading\" | \"done\";\ntype UseUploadFileDispatcher = (\n  file: Buffer | File | Blob,\n  metadata?: UploadMetadata,\n) => Promise<UploadResult>;\ntype UseUploadFile = {\n  state: UseUploadFileState;\n  dispatch: UseUploadFileDispatcher;\n};\n\nexport const useUploadFile = (reference: StorageReference): UseUploadFile => {\n  const [state, setState] = useState<UseUploadFileState>(\"ready\");\n\n  const dispatch: UseUploadFileDispatcher = async (file, metadata) => {\n    setState(\"loading\");\n    const result = await uploadBytes(reference, file, metadata);\n    setState(\"done\");\n    return result;\n  };\n\n  return { state, dispatch };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport {\n  StorageReference,\n  UploadMetadata,\n  UploadResult,\n  uploadBytesResumable,\n} from \"firebase/storage\";\nimport { useState } from \"react\";\n\ntype UseUploadFileResumableState = \"ready\" | [number, number] | \"done\";\ntype UseUploadFileResumableDispatcher = (\n  file: Buffer | File | Blob,\n  metadata?: UploadMetadata,\n) => Promise<UploadResult>;\ntype UseUploadFileResumable = {\n  state: UseUploadFileResumableState;\n  dispatch: UseUploadFileResumableDispatcher;\n};\n\nexport const useUploadFileResumable = (\n  reference: StorageReference,\n): UseUploadFileResumable => {\n  const [state, setState] = useState<UseUploadFileResumableState>(\"ready\");\n\n  const dispatch: UseUploadFileResumableDispatcher = async (file, metadata) => {\n    const task = uploadBytesResumable(reference, file, metadata);\n    task.on(\"state_changed\", (snapshot) => {\n      setState([snapshot.bytesTransferred, snapshot.totalBytes]);\n    });\n    const result = await task;\n    setState(\"done\");\n    return result;\n  };\n\n  return { state, dispatch };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { StorageReference, getDownloadURL } from \"firebase/storage\";\nimport { useState } from \"react\";\n\ntype UseDownloadLinkState = \"ready\" | \"loading\" | \"done\";\ntype UseDownloadLinkDispatcher = () => Promise<string>;\ntype UseDownloadLink = {\n  link: string | undefined;\n  state: UseDownloadLinkState;\n  dispatch: UseDownloadLinkDispatcher;\n};\n\nexport const useDownloadLink = (\n  reference: StorageReference,\n): UseDownloadLink => {\n  const [state, setState] = useState<UseDownloadLinkState>(\"ready\");\n  const [link, setLink] = useState<string | undefined>(undefined);\n\n  const dispatch: UseDownloadLinkDispatcher = async () => {\n    setState(\"loading\");\n    const url = await getDownloadURL(reference);\n    setState(\"done\");\n    setLink(link);\n    return url;\n  };\n\n  return { state, dispatch, link };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { StorageReference } from \"firebase/storage\";\nimport { ReactNode, useEffect } from \"react\";\nimport { useDownloadLink } from \".\";\n\ntype StorageDownloadLinkProps = {\n  reference: StorageReference;\n  onLoading?: () => ReactNode;\n  onDone: (link: string) => ReactNode;\n};\n\nexport const StorageDownloadLink = ({\n  reference,\n  onLoading = () => <></>,\n  onDone,\n}: StorageDownloadLinkProps) => {\n  const { link, state, dispatch } = useDownloadLink(reference);\n\n  useEffect(() => {\n    dispatch();\n  }, [dispatch]);\n\n  return state === \"done\" ? onDone(link!) : onLoading();\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { StorageReference, getBlob } from \"firebase/storage\";\nimport { useState } from \"react\";\n\ntype UseDownloadBlobState = \"ready\" | \"loading\" | \"done\";\ntype UseDownloadBlobDispatcher = (\n  maxDownloadSizeBytes?: number,\n) => Promise<Blob>;\ntype UseDownloadBlob = {\n  blob: Blob | undefined;\n  state: UseDownloadBlobState;\n  dispatch: UseDownloadBlobDispatcher;\n};\n\nexport const useDownloadBlob = (\n  reference: StorageReference,\n): UseDownloadBlob => {\n  const [state, setState] = useState<UseDownloadBlobState>(\"ready\");\n  const [blob, setBlob] = useState<Blob | undefined>(undefined);\n\n  const dispatch: UseDownloadBlobDispatcher = async (maxDownloadSizeBytes) => {\n    setState(\"loading\");\n    const blob = await getBlob(reference, maxDownloadSizeBytes);\n    setState(\"done\");\n    setBlob(blob);\n    return blob;\n  };\n\n  return { blob, state, dispatch };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { StorageReference, getBytes } from \"firebase/storage\";\nimport { useState } from \"react\";\n\ntype UseDownloadBytesState = \"ready\" | \"loading\" | \"done\";\ntype UseDownloadBytesDispatcher = (\n  maxDownloadSizeBytes?: number,\n) => Promise<ArrayBuffer>;\ntype UseDownloadBytes = {\n  bytes: ArrayBuffer | undefined;\n  state: UseDownloadBytesState;\n  dispatch: UseDownloadBytesDispatcher;\n};\n\nexport const useDownloadBytes = (\n  reference: StorageReference,\n): UseDownloadBytes => {\n  const [state, setState] = useState<UseDownloadBytesState>(\"ready\");\n  const [bytes, setBytes] = useState<ArrayBuffer | undefined>(undefined);\n\n  const dispatch: UseDownloadBytesDispatcher = async (maxDownloadSizeBytes) => {\n    setState(\"loading\");\n    const bytes = await getBytes(reference, maxDownloadSizeBytes);\n    setState(\"done\");\n    setBytes(bytes);\n    return bytes;\n  };\n\n  return { bytes, state, dispatch };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { StorageReference, deleteObject } from \"firebase/storage\";\nimport { useState } from \"react\";\n\ntype UseDeleteFileState = \"ready\" | \"loading\" | \"done\";\ntype UseDeleteFileDispatcher = () => Promise<void>;\ntype UseDeleteFile = {\n  state: UseDeleteFileState;\n  dispatch: UseDeleteFileDispatcher;\n};\n\nexport const useDeleteFile = (reference: StorageReference): UseDeleteFile => {\n  const [state, setState] = useState<UseDeleteFileState>(\"ready\");\n\n  const dispatch: UseDeleteFileDispatcher = async () => {\n    setState(\"loading\");\n    await deleteObject(reference);\n    setState(\"done\");\n  };\n\n  return { state, dispatch };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FullMetadata, StorageReference, getMetadata } from \"firebase/storage\";\nimport { useState } from \"react\";\n\ntype UseFileMetadataState = \"ready\" | \"loading\" | \"done\";\ntype UseFileMetadataDispatcher = () => Promise<FullMetadata>;\ntype UseFileMetadata = {\n  metadata: FullMetadata | undefined;\n  state: UseFileMetadataState;\n  dispatch: UseFileMetadataDispatcher;\n};\n\nexport const useFileMetadata = (\n  reference: StorageReference,\n): UseFileMetadata => {\n  const [state, setState] = useState<UseFileMetadataState>(\"ready\");\n  const [metadata, setMetadata] = useState<FullMetadata | undefined>(undefined);\n\n  const dispatch: UseFileMetadataDispatcher = async () => {\n    setState(\"loading\");\n    const metadata = await getMetadata(reference);\n    setState(\"done\");\n    setMetadata(metadata);\n    return metadata;\n  };\n\n  return { metadata, state, dispatch };\n};\n","// Copyright (c) 2024 Eray Erdin\n//\n// This software is released under the MIT License.\n// https://opensource.org/licenses/MIT\n\nimport { FullMetadata, StorageReference } from \"firebase/storage\";\nimport { ReactNode, useEffect } from \"react\";\nimport { useFileMetadata } from \".\";\n\ntype StorageMetadataProps = {\n  reference: StorageReference;\n  onLoading?: () => ReactNode;\n  onDone: (metadata: FullMetadata) => ReactNode;\n};\n\nexport const StorageMetadata = ({\n  reference,\n  onLoading = () => <></>,\n  onDone,\n}: StorageMetadataProps) => {\n  const { metadata, state, dispatch } = useFileMetadata(reference);\n\n  useEffect(() => {\n    dispatch();\n  }, [dispatch]);\n\n  return state === \"done\" ? onDone(metadata!) : onLoading();\n};\n"],"names":["useCollection","query","listen","listenToMetadataChanges","loading","setLoading","useState","snapshot","setSnapshot","error","setError","useEffect","onSnapshot","snap","getDocs","qSnapshot","e","FirebaseError","useDocument","reference","getDoc","useAddDocument","state","setState","refer","setRefer","data","docRef","addDoc","useSetDocument","options","setDoc","useDeleteDocument","deleteDoc","FirestoreDocument","onLoading","jsx","Fragment","onError","_err","onDone","processing","err","FirebaseAppContext","createContext","FirebaseProvider","app","children","FirestoreContext","FirestoreProvider","firestore","FirebaseAuthContext","FirebaseAuthProvider","auth","FirebaseFunctionsContext","FirebaseFunctionsProvider","functions","FirebaseStorageContext","FirebaseStorageProvider","storage","useUser","onChange","user","setUser","onAuthStateChanged","useSignOut","onlyRealAnon","SignOut","onReady","onAnonymous","dispatch","useSignUp","email","password","credential","createUserWithEmailAndPassword","useDeleteUser","includeFirebaseAnon","deleteUser","signOut","AuthorizationZone","validator","Validators","onSuccess","onFailure","success","setSuccess","taskOrVal","excludeFirebaseAnon","validators","results","v","vals","tasks","resolved","useSignIn","params","type","signInWithEmailAndPassword","actionCodeSetting","sendSignInLinkToEmail","provider","signInWithPopup","useSendEmailVerification","sendEmailVerification","useCallFunction","name","httpsCallableOptions","r","httpsCallable","useUploadFile","file","metadata","result","uploadBytes","useUploadFileResumable","task","uploadBytesResumable","useDownloadLink","link","setLink","url","getDownloadURL","StorageDownloadLink","useDownloadBlob","blob","setBlob","maxDownloadSizeBytes","getBlob","useDownloadBytes","bytes","setBytes","getBytes","useDeleteFile","deleteObject","useFileMetadata","setMetadata","getMetadata","StorageMetadata"],"mappings":"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"}